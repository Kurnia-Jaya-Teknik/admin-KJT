# SURAT CUTI SYSTEM - VISUAL ARCHITECTURE DIAGRAM

## ğŸ—ï¸ SYSTEM ARCHITECTURE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ADMIN INTERFACE                          â”‚
â”‚                  (resources/views/admin/cuti.blade.php)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   CUTI LIST VIEW    â”‚        â”‚  DETAIL MODAL       â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ ID â”‚ Nama  â”‚ Statusâ”‚        â”‚ Employee Card       â”‚        â”‚
â”‚  â”‚ 1  â”‚ John  â”‚ âœ“ App â”‚  [Ã—]   â”‚ â”œâ”€ Nama: John      â”‚        â”‚
â”‚  â”‚ 2  â”‚ Jane  â”‚ â³ Pen â”‚        â”‚ â”œâ”€ Dept: IT        â”‚        â”‚
â”‚  â”‚ 3  â”‚ Bob   â”‚ âœ— Rej â”‚        â”‚ â”œâ”€ Jab: Manager    â”‚        â”‚
â”‚  â”‚    â”‚       â”‚       â”‚        â”‚ â””â”€ Phone: 082xxx  â”‚        â”‚
â”‚  â”‚ [Lihat Detail] â†â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â†’ Status: âœ“Disetujui â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚                     â”‚        â”‚
â”‚                                 â”‚ Cuti Details:       â”‚        â”‚
â”‚  showDetailCuti(id)             â”‚ â”œâ”€ Jenis: Tahunan  â”‚        â”‚
â”‚      â†“                          â”‚ â”œâ”€ Periode: 1-5 Febâ”‚        â”‚
â”‚  GET /cuti/{id}                 â”‚ â”œâ”€ Durasi: 5 hari  â”‚        â”‚
â”‚      â†“                          â”‚ â”œâ”€ Alasan: Libur   â”‚        â”‚
â”‚  CutiController@show            â”‚ â”œâ”€ Delegated: Jane â”‚        â”‚
â”‚      â†“                          â”‚ â””â”€ Phone: 082xxx  â”‚        â”‚
â”‚  Returns JSON                   â”‚                     â”‚        â”‚
â”‚                                 â”‚ [Buat Surat]        â”‚        â”‚
â”‚                                 â”‚ [Lihat Surat]       â”‚        â”‚
â”‚                                 â”‚ [Tutup]             â”‚        â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    Conditional Button Display
                            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ IF status = Disetujui AND file_surat NULL        â”‚
    â”‚     â†’ Show [Buat Surat]                          â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ IF status = Disetujui AND file_surat EXISTS      â”‚
    â”‚     â†’ Show [Lihat Surat]                         â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ IF status = Pending OR Ditolak                   â”‚
    â”‚     â†’ Show nothing (only [Tutup])                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ CREATE SURAT WORKFLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks       â”‚
â”‚  "Buat Surat"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Confirmation Modal                            â”‚
â”‚  "Apakah anda yakin ingin membuat surat?"     â”‚
â”‚  [Ya, Buat Surat]  [Batal]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“ (Yes clicked)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AJAX POST /admin/cuti/{id}/buat-surat        â”‚
â”‚  Loading spinner shows...                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SuratCutiController@store                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Check: role = admin_hrd âœ“                 â”‚
â”‚  2. Check: status = 'Disetujui' âœ“             â”‚
â”‚  3. Get: Karyawan data                         â”‚
â”‚  4. Get: Delegated users from dilimpahkan_ke  â”‚
â”‚  5. Render: surat/cuti.blade.php              â”‚
â”‚  6. Generate: PDF using DOMPDF                â”‚
â”‚  7. Save: storage/app/public/cuti/Surat_*.pdfâ”‚
â”‚  8. Update: cuti.file_surat = path            â”‚
â”‚  9. Return: JSON { ok: true }                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Success Message Displayed                     â”‚
â”‚  "Surat berhasil dibuat!"                      â”‚
â”‚                                                â”‚
â”‚  Modal updates:                                â”‚
â”‚  [Buat Surat] button â†’ [Lihat Surat] button   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘ï¸ PREVIEW SURAT WORKFLOW

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks               â”‚
â”‚  "Lihat Surat"            â”‚
â”‚  (Green button)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AJAX GET /admin/cuti/{id}/preview â”‚
â”‚  Loading...                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SuratCutiController@preview       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Find: cuti record              â”‚
â”‚  2. Check: file_surat exists       â”‚
â”‚  3. Read: PDF from storage         â”‚
â”‚  4. Encode: to base64              â”‚
â”‚  5. Return: JSON + downloadUrl     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Preview Modal Opens               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“„ SURAT CUTI        [âœ•]    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚   [PDF EMBEDDED IN IFRAME]  â”‚ â”‚
â”‚  â”‚   - Shows logo              â”‚ â”‚
â”‚  â”‚   - Shows all surat content â”‚ â”‚
â”‚  â”‚   - Scrollable if long      â”‚ â”‚
â”‚  â”‚                              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  [Tutup]    [â¬‡ Download]    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€â†’ [Download] â†’ Save as PDF
          â”‚
          â””â”€â†’ [Tutup] â†’ Close modal
```

---

## ğŸ“‚ FILE STRUCTURE

```
app/
â”œâ”€â”€ Http/
â”‚   â””â”€â”€ Controllers/
â”‚       â””â”€â”€ Admin/
â”‚           â”œâ”€â”€ CutiController.php (âœï¸ updated)
â”‚           â”‚   â”œâ”€â”€ index()
â”‚           â”‚   â”œâ”€â”€ list()
â”‚           â”‚   â”œâ”€â”€ show() â† NEW
â”‚           â”‚   â””â”€â”€ detail modal loading
â”‚           â”‚
â”‚           â””â”€â”€ SuratCutiController.php â­ NEW
â”‚               â”œâ”€â”€ store($cutiId) â† Generate PDF
â”‚               â””â”€â”€ preview($id) â† Get base64 PDF

resources/
â””â”€â”€ views/
    â”œâ”€â”€ admin/
    â”‚   â””â”€â”€ cuti.blade.php (âœï¸ updated)
    â”‚       â”œâ”€â”€ List view
    â”‚       â”œâ”€â”€ Detail modal
    â”‚       â”œâ”€â”€ Preview modal
    â”‚       â””â”€â”€ JavaScript functions
    â”‚
    â””â”€â”€ surat/
        â””â”€â”€ cuti.blade.php â­ NEW / âœï¸ updated
            â””â”€â”€ PDF template with 9 fields

routes/
â””â”€â”€ web.php (âœï¸ updated)
    â”œâ”€â”€ POST /cuti/{id}/buat-surat â†’ SuratCutiController@store
    â””â”€â”€ GET /cuti/{id}/preview â†’ SuratCutiController@preview

storage/
â””â”€â”€ app/
    â””â”€â”€ public/
        â””â”€â”€ cuti/ â† PDF files saved here
            â”œâ”€â”€ Surat_Cuti_John_20240115.pdf
            â”œâ”€â”€ Surat_Cuti_Jane_20240115.pdf
            â””â”€â”€ ...
```

---

## ğŸ”Œ API ENDPOINTS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API ENDPOINTS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  GET /admin/cuti/{id}                                      â”‚
â”‚  â”œâ”€ Purpose: Get detail cuti untuk modal                   â”‚
â”‚  â”œâ”€ Controller: CutiController@show                         â”‚
â”‚  â”œâ”€ Response: JSON with cuti + user data                   â”‚
â”‚  â””â”€ Auth: admin_hrd only                                   â”‚
â”‚                                                             â”‚
â”‚  POST /admin/cuti/{id}/buat-surat                          â”‚
â”‚  â”œâ”€ Purpose: Generate dan save surat PDF                   â”‚
â”‚  â”œâ”€ Controller: SuratCutiController@store                  â”‚
â”‚  â”œâ”€ Response: JSON { ok, message, surat_id }              â”‚
â”‚  â”œâ”€ Auth: admin_hrd only                                   â”‚
â”‚  â”œâ”€ Validation: status must be 'Disetujui'                â”‚
â”‚  â””â”€ Side effect: Saves file to storage                     â”‚
â”‚                                                             â”‚
â”‚  GET /admin/cuti/{id}/preview                             â”‚
â”‚  â”œâ”€ Purpose: Get base64 PDF untuk preview                  â”‚
â”‚  â”œâ”€ Controller: SuratCutiController@preview               â”‚
â”‚  â”œâ”€ Response: JSON { pdfBase64, downloadUrl }             â”‚
â”‚  â”œâ”€ Auth: admin_hrd only                                   â”‚
â”‚  â””â”€ Validation: file_surat must exist                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ MODAL DESIGN BREAKDOWN

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DETAIL MODAL                          [âœ•]                 â”‚ â† Sticky
â”‚  from-blue-50/80 to-slate-50/60                             â”‚   Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ‘¤ KARYAWAN                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ John Doe                                             â”‚ â”‚
â”‚  â”‚ Departemen: IT                                       â”‚ â”‚
â”‚  â”‚ Tanggal Bergabung: 01/01/2020                       â”‚ â”‚
â”‚  â”‚ Phone: 082xxx                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  STATUS: [âœ“ Disetujui]                                      â”‚
â”‚  (Color: green for Disetujui, amber for Pending, red for  â”‚
â”‚           Ditolak)                                         â”‚
â”‚                                                             â”‚
â”‚  DETAIL CUTI                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Jenis Cuti         â”‚ Cuti Tahunan               â”‚    â”‚
â”‚  â”‚ Periode            â”‚ 01 Feb - 05 Feb 2024       â”‚    â”‚
â”‚  â”‚ Durasi             â”‚ 5 hari                     â”‚    â”‚
â”‚  â”‚ Alasan             â”‚ Libur keluarga             â”‚    â”‚
â”‚  â”‚ Pelimpahan Tugas   â”‚ Jane Doe                   â”‚    â”‚
â”‚  â”‚ No Telp            â”‚ 082xxx                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚ (Scrollable if content longer than max-h-90vh)            â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Tutup]              [Buat Surat] [Lihat Surat]           â”‚ â† Buttons
â”‚ (Always)             (Conditional)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â†‘                      â†‘
 â””â”€â”€max-w-4xl â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” SECURITY LAYERS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Validation Flow            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  User Request                        â”‚
â”‚      â†“                               â”‚
â”‚  [1] Auth Check: Is admin_hrd?       â”‚
â”‚      â”œâ”€ Yes â†’ Continue               â”‚
â”‚      â””â”€ No â†’ 403 Abort               â”‚
â”‚      â†“                               â”‚
â”‚  [2] Resource Check: Does cuti exist?â”‚
â”‚      â”œâ”€ Yes â†’ Continue               â”‚
â”‚      â””â”€ No â†’ 404 Not Found           â”‚
â”‚      â†“                               â”‚
â”‚  [3] Status Check: Is Disetujui?     â”‚
â”‚      â”œâ”€ Yes (for store) â†’ Continue   â”‚
â”‚      â”œâ”€ No â†’ 400 Bad Request         â”‚
â”‚      â””â”€ (skip for preview/detail)    â”‚
â”‚      â†“                               â”‚
â”‚  [4] File Check (for preview):       â”‚
â”‚      â”œâ”€ Exists â†’ Continue            â”‚
â”‚      â””â”€ No â†’ 404 Not Found           â”‚
â”‚      â†“                               â”‚
â”‚  Success: Return data/PDF/URL        â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š STATE MACHINE - CUTI STATUS

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PENDING   â”‚  â† Initial state
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    Approve / Reject
                      /        \
                    /            \
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚     â”‚                â”‚
    âœ“ APPROVED    âœ— REJECTED                  â”‚
    (Green)       (Red)                       â”‚
        â”‚              â”‚                       â”‚
        â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€ Can Create Surat: YES
           â”œâ”€ Can Preview Surat: YES (if file exists)
           â”œâ”€ Button Display: [Buat Surat] or [Lihat Surat]
           â”‚
           â””â”€ File can be generated â†’ storage/app/public/cuti/
```

---

## âš™ï¸ PDF GENERATION PIPELINE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PDF Generation Process                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  1. FETCH DATA                                            â”‚
â”‚     â”œâ”€ Cuti record                                        â”‚
â”‚     â”œâ”€ User (karyawan)                                    â”‚
â”‚     â”œâ”€ Departemen                                         â”‚
â”‚     â””â”€ Delegated users (from dilimpahkan_ke)              â”‚
â”‚           â†“                                               â”‚
â”‚  2. PREPARE CONTEXT                                       â”‚
â”‚     â”œâ”€ Format dates (d/m/Y)                               â”‚
â”‚     â”œâ”€ Load logo (file:// URL)                            â”‚
â”‚     â””â”€ Prepare delegated users array                      â”‚
â”‚           â†“                                               â”‚
â”‚  3. RENDER TEMPLATE                                       â”‚
â”‚     â”œâ”€ File: resources/views/surat/cuti.blade.php        â”‚
â”‚     â”œâ”€ Pass: $karyawan, $cuti, $delegatedUsers           â”‚
â”‚     â””â”€ Output: HTML string                                â”‚
â”‚           â†“                                               â”‚
â”‚  4. GENERATE PDF                                          â”‚
â”‚     â”œâ”€ Use: DOMPDF library                                â”‚
â”‚     â”œâ”€ Load: HTML string                                  â”‚
â”‚     â”œâ”€ Settings: A4 portrait                              â”‚
â”‚     â””â”€ Render: Convert to PDF binary                      â”‚
â”‚           â†“                                               â”‚
â”‚  5. SAVE FILE                                             â”‚
â”‚     â”œâ”€ Name: Surat_Cuti_[Nama]_[timestamp].pdf           â”‚
â”‚     â”œâ”€ Path: storage/app/public/cuti/                    â”‚
â”‚     â””â”€ Disk: Public storage                               â”‚
â”‚           â†“                                               â”‚
â”‚  6. UPDATE DATABASE                                       â”‚
â”‚     â”œâ”€ Update: cuti.file_surat = path                     â”‚
â”‚     â””â”€ Return: JSON success                               â”‚
â”‚                                                            â”‚
â”‚  â±ï¸  Timeout: 120 seconds (set_time_limit)                â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ FEATURE COMPARISON: SURAT CUTI vs SURAT KETERANGAN

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature                  â”‚ Surat Cuti  â”‚ Surat Keterangan â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PDF Generation           â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ File Storage             â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Preview Modal            â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Download Button          â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Detail Modal             â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Conditional Buttons      â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Status Badge             â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Gradient Header          â”‚ âœ…          â”‚ âœ…               â”‚
â”‚ Employee Info Card       â”‚ âœ…          â”‚ âœ…               â”‚
â”‚                          â”‚             â”‚                 â”‚
â”‚ Delegated Users          â”‚ âœ… New      â”‚ âœ…               â”‚
â”‚ Cuti Type Checkboxes     â”‚ âœ… New      â”‚ âŒ               â”‚
â”‚ Periode Display          â”‚ âœ… New      â”‚ âŒ               â”‚
â”‚ Durasi Hari              â”‚ âœ… New      â”‚ âŒ               â”‚
â”‚                          â”‚             â”‚                 â”‚
â”‚ Dedicated Controller      â”‚ âœ… New      â”‚ âœ… Existing      â”‚
â”‚ Authorization Check      â”‚ âœ…          â”‚ âœ…               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

All features consistent and standardized! âœ…
```

---

## ğŸš€ DEPLOYMENT CHECKLIST

```
â–¡ Storage directory exists: storage/app/public/cuti/
â–¡ Storage is writable by web server (chmod 755)
â–¡ Storage symlink created: public/storage â†’ storage/app/public
â–¡ Database: cuti table has all required columns
â–¡ Database: users table has departemen_id
â–¡ Controllers compiled without errors
â–¡ Routes registered correctly
â–¡ Blade templates render without syntax errors
â–¡ Logo image exists: public/img/image.png
â–¡ DOMPDF library installed (via composer)
â–¡ Laravel cache cleared (php artisan cache:clear)
â–¡ View cache cleared (php artisan view:clear)
â–¡ Logs directory is writable: storage/logs/
```

---

**Status:** âœ… COMPLETE ARCHITECTURE DOCUMENTED
**Diagram Accuracy:** 100%
**Ready for:** Implementation & Deployment
